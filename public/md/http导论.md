### 一、概念

- http

  直译：超文本传输协议

- 超文本

  含有指向其他资源链接内容的文本

- 常见状态码

  - 1xx 提示信息
  - 2xx 成功
  - 3xx 重定向
  - 4xx 客户端错误
  - 5xx 服务端错误

- 无状态

  - 每个请求都是完全独立的，每包含了处理这个请求所需的完整的数据，不依赖于其他请求。
  - 服务器也不会保留任何关于客户端的状态信息

### 二、同源策略

- 每个网站 是一个独立的小区
- 同源策略 是小区严格的门禁系统：**只允许本小区住户（同源请求）自由进出**
- 跨域请求 就像你想从“A小区”去“B小区的朋友家做客”
- 浏览器 是尽职的保安，默认会**阻止这种跨小区访问**

1. 协议相同
2. 域名相同
3. 端口相同

以上三个组合起来其实就是一个完整域名前缀地址，如：`https://xxx.com`

所以我们在项目中调用的接口地址：`https://xxx.com/xxxx`，是符合同源策略的

一旦不符合同源策略，就会出现**跨域问题**，解决方案要么前端nginx代理转发，要么后端代理转发

<mark> 一个特殊情况：https 的页面发送不了 http 请求</mark>

> 看起来是同源策略的问题，实际上还没到那一步，**混合内容的安全策略**是在浏览器端判定的，而是否能跨域要看服务器返回的Response头，请求都被浏览器block掉了，也就不存在是否跨域的问题。

#### 如何实现跨域

- CORS（跨域资源共享）

  原理：B小区（服务器）告诉保安（浏览器）：“我允许A小区的访客进来”

  前端：几乎不用做特殊处理，正常发请求即可

- JSONP（只支持get）

  原理：利用`<script>` 标签没有跨域限制的特性

  后端：返回JS函数调用，而不是JSON

  前端：

  ```html
  <!-- 通过添加一个 script 标签，指定 src 属性为跨域请求的 URL，而这个 URL 返回的不是 JSON 数据，而是一段可执行的 JavaScript 代码，这段代码会调用一个指定的函数，并且将 JSON 数据作为参数传入函数中 -->
  <script>
    function handleResponse(data) {
      console.log('收到数据:', data);
    }
  </script>
  <!-- 后端需要返回类似 handleResponse({...}) 的JS代码 -->
  <script src="https://api.other-site.com/data?callback=handleResponse"></script>
  ```

- 代理服务器(前端开发常用)

  就是工作中最常用的那一套

  原理：让同源的代理服务器转发请求，绕过**浏览器限制**。

  开发环境（Vite/Webpack配置）、生产环境（Nginx配置）

### 三、http不同版本的区别

HTTP 协议从开始立项到现在一共经历了 4 个版本

`HTTP 0.9 -> HTTP 1.0 -> HTTP 1.1 -> HTTP 2`

- http0.9

  - **只支持GET请求方式**：由于不支持其他请求方式，因此客户端是没办法向服务端传输太多的信息
  - **没有请求头概念**：所以不能在请求中指定版本号，服务端也只具有返回 HTML字符串的能力
  - **服务端响应之后，立即关闭TCP连接**

- http1.0

  - **请求方式**新增了POST，DELETE，PUT，HEADER等方式
  - 增添了**请求头和响应头**的概念，在通信中指定了 HTTP 协议版本号，以及其他的一些元信息 (比如: 状态码、权限、缓存、内容编码)
  - 扩充了传输内容格式`Content-Type`，图片、音视频资源、二进制等都可以进行传输

- http1.1

  - 长连接

    http1.1默认保持长连接，数据传输完成保持tcp连接不断开,继续用这个通道传输数据

  - 管道化

    基于上面长连接的基础，管道化可以不等第一个请求响应继续发送后面的请求，**但响应的顺序还是按照请求的顺序返回**(这句注意，是局限)

    > 管道：可以理解为队列，先进先出（拓展：知识密封准则，这是宇宙中文明世界的最高准则之一，它不允许高级文明向低级文明传播知识--我们把这种行为叫知识的**管道传递**）

  - 缓存处理

    当浏览器请求资源时，先看是否有缓存的资源，如果有缓存，直接取，不会再发请求，如果没有缓存，则发送请求通过设置字段`cache-control`来控制

  - 断点传输

    在上传/下载资源时，如果资源过大，将其分割为多个部分，分别上传/下载，如果遇到网络故障，可以从已经上传/下载好的地方继续请求，不用从头开始，提高效率

- http2.0
  - 二进制分帧：将所有传输的信息分割为更小的消息和帧,并对它们采用二进制格式的编码。
  - 多路复用：基于二进制分帧，在同一域名下所有访问都是从同一个tcp连接中走，**http消息被分解为独立的帧，乱序发送，服务端根据标识符和首部将消息重新组装起来**
  - 头部压缩：HTTP 2.0会对HTTP的头进行一定的压缩，将原来每次都要携带的大量key value在两端建立一个索引表，对相同的头只发送索引表中的索引。
  - 服务器推送：服务器可以额外的向客户端推送资源，而无需客户端明确的请求

<mark>http1.0 到http1.1的主要区别，就是**从无连接到长连接**，http2.0对比1.X版本主要区别就是**多路复用**</mark>

### 四、http和https

HTTPS是在HTTP的基础上加入了**SSL协议**，SSL依靠**证书**来验证服务器的身份，并为浏览器和服务器之间的通信加密（在传输层）

HTTP + 加密 + 认证 + 完整性保护 = HTTPS

- HTTPS 协议需要申请证书
- HTTP 和 HTTPS 使用端口不一样，前者是80，后者是443
- HTTP 协议运行在 TCP 之上，所有传输的内容都是明文，HTTPS 运行在 SSL/TLS（安全传输层协议） 之上，SSL/TLS运行在TCP之上，所有传输的内容都经过加密的
