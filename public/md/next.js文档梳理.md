### 前言

#### 1、历史

- nextJs的母公司是Vercel

- nextJs的存在主要是为了解决react的一些问题

#### 2、SPA单页应用弊端

- js bundle

  就是编译打包后的js包

- 严重依赖用户侧的js环境

  用户的浏览器里必须有js环境（如果禁用了js环境，SPA完全不可用）

- 首屏加载慢

  因为要加载很多的js bundle（有优化措施如切分js bundle，首屏只加载需要的js bundle）

- 潜在的安全性问题
- 不利于SEO

#### 3、next.js是如何解决这些问题的

- 渲染后移

  渲染指将需要展示的数据渲染成DOM（注意DOM渲染成图像这一层是浏览器干的活）

#### 4、SSR和CSR

- SSR（Server-Side-Rendering，服务器端渲染）

  使用服务器端渲染的返回的页面是完整的HTML页面。每次发生少量更改都需要重新渲染整个页面

  更好的SEO，初始页面加载速度更快，非常适合静态网站

- CSR（Client-Side-Rendering，客户端渲染）

  客户端渲染代表渲染内容部分转嫁到JS身上。客户端只是从服务器得到相对简单的HTML文档，然后使用JS文件对页面的显示内容进行控制。

> 服务器端渲染的优势在于首屏渲染速度块，简单来讲它不需要来回多次往返于客户端和服务端。但是其性能等众多因素会影响用户体验，比如说：网速，在线活跃人数，服务器的物理位置等等。而客户端渲染则和服务端渲染相反，因为多次和服务器的交互导致首屏加载速度慢。但一旦这些请求完成之后，用户和页面之间的交互时用户体验就会好很多。

> 用一个现实生活的例子来看：假如从超市买东西吃，以SSR的角度来看，你每次在超市买完随即吃完再走，每次饿了都需要出发去超市。而从CSR的角度来看，就是你从超市购买许多原材料再拿回家去自己煮，多了能放冰箱，这样每次肚子饿了就不需要每次都往超市跑，唯一麻烦一点在于你得花时间挑选食材。

**简而言之，SSR强在首屏渲染。而CSR强在用户和页面多交互的场景。**

### 一、上手

注意，不需要提前准备好文件夹

目录结构：

![ ](https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftop-level-folders.png&w=3840&q=75)

### 二、nextJs优化

Next.js 附带各种内置优化，旨在提高应用程序的速度和核心 Web 生命力

#### 1、字体优化

`Next.js` 在使用 `next/font` 模块时会自动优化应用程序中的字体。**它在构建时下载字体文件并将其托管在其他静态资产之中**。这意味着当用户访问应用程序时，**不会有额外的字体网络请求**，从而不会影响性能。亦不会造成**累积布局移位**。

支持谷歌字体和本地字体，用法参考[Font API Reference](https://nextjs.org/docs/app/api-reference/components/font)

```js
// 自动自行托管任何 Google 字体。字体包含在部署中，并由与部署相同的域提供服务。浏览器不会向 Google 发送任何请求。
import { Inter } from 'next/font/google';

const inter = Inter({ subsets: ['latin'] });

<div className={inter.className}>
  <p>Hello World</p>
</div>;

// 导入 next/font/local 并指定本地字体文件的 src
import localFont from 'next/font/local';

const myFont = localFont({ src: './my-font.woff2' });

<div className={myFont.className}>
  <p>Hello World</p>
</div>;
```

#### 2、图片优化

图片优化是 Web 开发中一个庞大的主题，可以被认为是一门专业领域。与手动实现这些优化相比，可以使用 `next/image` 组件来自动优化图片。

`<Image>` 组件是 HTML `<img>` 标签的扩展，具有自动图像优化功能，包括：

- 图片加载时自动防止布局移位。
- 调整图像大小，避免向视口较小的设备传送大图像。
- 默认情况下懒加载图像（图像在进入视口时加载）。
- 在浏览器支持的情况下，以现代格式提供图像，如 WebP 和 AVIF。

#### 3、其他

脚本、静态资源等等

### 三、nextJs内置组件

#### 1、元数据

有两种方法可以向应用程序添加元数据：

- 基于配置

  Next.js 提供了一个 Metadata API，可用于定义应用程序的元数据。

  ```js
  import type { Metadata } from "next";

  export const metadata: Metadata = {
    title: "Create Next App",
    description: "Generated by create next app",
  };
  ```

- 基于文件

  Next.js 有一系列专门用于元数据目的的特殊文件（如`favicon.ico`）

#### 2、layout.tsx

在 Next.js 中 `app/layout.tsx` 这个文件是布局文件，每个页面都会默认复用这个文件，除非在子页面创建新的 layout.tsx 文件

在 Next.js 中使用布局的一个好处是，在导航时，只有页面组件会更新，而布局不会重新渲染。这被称为部分渲染。

#### 3、路由

Next.js 使用文件系统路由，其中文件夹用于创建嵌套路由。每个文件夹代表一个路由段，对应到一个 URL 段。

直接在app文件夹中创建路由页面文件夹，在其中添加 page.tsx 文件

要创建嵌套路由，可以将文件夹嵌套在彼此之内，并在其中添加 page.tsx 文件

### 引用

> [15min快速上手nextjs](https://www.bilibili.com/video/BV14t4y187Kk/?spm_id_from=333.337.search-card.all.click&vd_source=2b211224d72ed36d88f40e2d2a243144)[Learn Next.js 中文教程](https://qufei1993.github.io/nextjs-learn-cn/chapter16)[官方文档（配合网页中英翻译使用）](https://nextjs.org/docs/pages/building-your-application/optimizing)
